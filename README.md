# Test Cases Manually Added and Generated by KLEE's Shadow Symbolic Execution

This dataset contains test cases that were manually designed and automatically generated using [KLEE](https://github.com/klee/klee)'s shadow symbolic execution (see [Shadow ICSE2016](https://srg.doc.ic.ac.uk/publications/shadow-icse-16.html)) and employed in the empirical study: [An Empirical Study on Mutation, Statement and Branch Coverage Fault Revelation that Avoids the Unreliable Clean Program Assumption (ICSE2017)](https://thierry-tct.github.io/publication/cpa-mfi_icse2017/).

These tests were designed to run on the version pre/post bux fixing commit of 68 of the 70 [CoreBEnch](http://www.comp.nus.edu.sg/~release/corebench/) subjects. __Users just need integrate these tests with CoreBEnch, for compilation of ```OLD``` and ```NEW``` verions (see bellow), and run the tests.__

```OLD``` version represents the version _**pre** bug fixing commit_
```NEW``` version represents the version _**post** bug fixing commit_

These tests use the ```NEW``` version's output as oracle to test ```OLD``` version, therefore requires both ```OLD``` version and ```NEW``` version to be compiled.

## Integration with Corebench
Insert the call to the CoreBEnch script for building respectively the version _pre bug fix commit (OLD)_ and _post bug fix commit (NEW)_ into the script ```corebenchBuild.sh```. The executables generated after compilation will be copied into the directory ```build-versions``` described bellow.

## Directory structure
1. ```klee-replay``` contain the executable of the program _klee-replay_ (version used by shadow version of KLEE) necessary to execute KLEE's generated tests.
2. ```subjects``` contain 68 directory of the 70 bugs of corebench (except IDs 64 and 65). each directory name represent the corresponding CoreBEnch bug ID.
    Each subject contain:
    - ```testscripts``` which contains the modified version of the tests scripts of the programs.
    - ```genktests``` which contains the _.ktest_ files generated by KLEE's Shadow and and based on the tests in _testscripts_
    - ```build-versions``` where the executables are store and used in a wrapper duringtest execution
    - ```test-verdict-output``` contains the result of test execution in a file ```<bugID>-ktestPassFail.txt``` (automatically created during test execution). in the file, __0__ means test _pass_ and __1__ means test _fail_.
    Note: the list of test generated and manually added are found in ```<bugID>-ktestlist.txt```

## Run the tests
call the script ```run.sh``` with the ```corebench bug ID```, the ```repo root directory``` and the keyword ```tests``` in order to execute all the tests. for example, assume that the subject bugID __1__ have the repo directory _path/to/repo/1_. the test execution will be:
```bash
   ./run.sh 1 path/to/repo/1 tests
```

This command will first copy the tests from ```testscripts``` into the repository, then execute the tests and store the results into ```test-verdict-output``` , and finaly restore the original test of the repo. 

-----------------------------------------------------

_By Thierry Titcheu Chekam_
[_University of Luxembourg (SnT)_](http://wwwen.uni.lu/snt/people/thierry_titcheu_chekam)

_**Email:**_ thierry.titcheu-chekam@uni.lu

_please contact me if you have questions about this._
 
-----------------------------------------------------
